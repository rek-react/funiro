class Gallery{static defaults={wheel:!1,spaceBetween:30,visibleItems:1,galleryPopup:!0,border:0,responsive:!1,autoScroll:!1,interval:3e3,nav:!0,dotts:!1,keyControl:!1,mouse:!1,animated:!1,baseTransition:.4,delayTimer:250,touch:!0,limit:30,visibilityStart:!1};static LEFT=37;static RIGHT=39;constructor(t,s){this.gallery=t,this.setup=s,this.slider=this.gallery.querySelector(".slider"),this.stage=this.gallery.querySelector(".stage"),this.items=this.gallery.querySelectorAll(".item"),this.count=this.items.length,this.current=0,this.next=0,this.pressed=!1,this.start=0,this.shift=0,this.init()}static extend(t){t=t||{};for(let s=1;s<arguments.length;s++)if(arguments[s])for(let e in arguments[s])arguments[s].hasOwnProperty(e)&&(t[e]=arguments[s][e]);return t}static xpos(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}init(){this.options=Gallery.extend({},Gallery.defaults,this.setup),this.setSizeCarousel(),this.setCoordinates(),this.initControl(),this.options.galleryPopup&&this.galleryPopup(),this.events||this.registerEventsHandler()}setSizeCarousel(){this.widthSlider=this.slider.offsetWidth,this.options.responsive&&this.setAdaptiveOptions(),this.max=this.count-this.options.visibleItems;const t=(this.widthSlider-this.options.spaceBetween*(this.options.visibleItems-1))/this.options.visibleItems;this.width=t+this.options.spaceBetween,this.widths=this.width*this.count,this.stage.style.width=this.widths+"px";for(let s of this.items)s.style.cssText=`width:${t}px; margin-right:${this.options.spaceBetween}px;`;this.options.visibilityStart&&(this.gallery.style.visibility="hidden",setTimeout((()=>{this.gallery.style.visibility="visible"}),350))}setCoordinates(){let t=0;for(this.coordinates=[];this.coordinates.length<this.count;)this.coordinates.push(t),t-=this.width}initControl(){this.navGallery=this.gallery.querySelector(".nav-gallery"),this.dottsGallery=this.gallery.querySelector(".dotts-gallery"),!0===this.options.nav?(this.btnPrev=this.navGallery.querySelector("[data-shift=prev]"),this.btnNext=this.navGallery.querySelector("[data-shift=next]"),this.setNavStyle(),this.navGallery.dataset.hidden=!1):this.navGallery.dataset.hidden=!0,!0===this.options.dotts?(this.creatDotsCtrl(),this.dottsGallery.dataset.hidden=!1):this.dottsGallery.dataset.hidden=!0}setAdaptiveOptions(){const t=document.documentElement.clientWidth,s=[];let e;for(let t in this.options.adaptive)s.push(t);for(let i=0,o=s.length;i<o;i++){let o=s[i],h=void 0!==s[i+1]?s[i+1]:s[i];t<=s[0]?e=s[0]:t>=o&&t<h?e=o:t>=s[s.length-1]&&(e=s[s.length-1])}const i=this.options.adaptive[e];for(let t in i)this.options[t]=i[t]}setNavStyle(){this.btnPrev.classList.remove("disable"),this.btnNext.classList.remove("disable"),0==this.current?this.btnPrev.classList.add("disable"):this.current>=this.count-this.options.visibleItems&&this.btnNext.classList.add("disable")}creatDotsCtrl(){this.spots=[],this.dottsGallery.innerHTML="";const t=document.createElement("li"),s=document.createElement("span");let e,i=0,o=0;for(t.appendChild(s);i<this.count;)e=t.cloneNode(!0),this.dottsGallery.appendChild(e),this.spots.push(e),i+=this.options.visibleItems,o=i<=this.max?o-this.width*this.options.visibleItems:-this.width*this.max;this.setDotsStyle()}setDotsStyle(){for(let t of this.spots)t.classList.remove("active");const t=this.next<this.max?Math.trunc(this.next/this.options.visibleItems):this.spots.length-1;this.spots[t].classList.add("active")}registerEventsHandler(t){window.addEventListener("resize",this.resize.bind(this)),this.options.autoScroll&&setInterval((()=>this.autoScroll()),this.options.interval),this.options.nav&&this.navGallery.addEventListener("click",this.navControl.bind(this)),this.options.dotts&&this.dottsGallery.addEventListener("click",this.dotsControl.bind(this)),this.options.keyControl&&window.addEventListener("keydown",this.keyControl.bind(this)),this.options.wheel&&this.slider.addEventListener("wheel",this.wheelControl.bind(this)),this.options.mouse&&(this.stage.addEventListener("mousedown",this.tap.bind(this)),this.stage.addEventListener("mousemove",this.drag.bind(this)),this.stage.addEventListener("mouseup",this.release.bind(this)),this.stage.addEventListener("mouseout",this.release.bind(this))),this.options.touch&&(this.stage.addEventListener("touchstart",this.tap.bind(this)),this.stage.addEventListener("touchmove",this.drag.bind(this)),this.stage.addEventListener("touchend",this.release.bind(this)),this.events=!0)}resize(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout((()=>{this.init(),this.current=this.current<=this.max?this.current:this.max;let t=this.coordinates[this.current];this.scroll(t,this.options.baseTransition)}),this.options.delayTimer)}autoScroll(t){const s=this.getNextCoordinates(1);this.scroll(s,this.options.baseTransition)}navControl(t){if("SPAN"!=t.target.tagName)return;const s="next"===t.target.dataset.shift?1:-1,e=this.getNextCoordinates(s);this.scroll(e,this.options.baseTransition)}dotsControl(t){if("LI"!=t.target.tagName||t.target.classList.contains("active"))return;const s=this.spots.indexOf(t.target);if(-1==s)return;this.next=s*this.options.visibleItems,this.next=this.next<=this.max?this.next:this.max;const e=this.coordinates[this.next],i=Math.abs(this.current-this.next),o=this.options.baseTransition+.07*i;this.scroll(e,o)}keyControl(t){if(t.which!==Gallery.RIGHT&&t.which!==Gallery.LEFT)return;const s=t.which===Gallery.RIGHT?1:-1,e=this.getNextCoordinates(s);this.scroll(e,this.options.baseTransition)}wheelControl(t){t.preventDefault();const s=t.deltaY>0?1:-1,e=this.getNextCoordinates(s);this.scroll(e,this.options.baseTransition)}tap(t){t.preventDefault(),t.stopPropagation(),t.which&&1!=t.which||(this.start=Gallery.xpos(t),this.pressed=!0)}drag(t){if(t.preventDefault(),t.stopPropagation(),!1===this.pressed)return;if(this.shift=this.start-Gallery.xpos(t),Math.abs(this.shift)<3)return;const s=this.widths-this.width*this.options.visibleItems,e=this.coordinates[this.current]-this.shift;e>this.options.limit||Math.abs(e)-s>this.options.limit||this.scroll(e,0)}release(t){if(t.preventDefault(),t.stopPropagation(),!1===this.pressed)return;const s=Math.abs(this.shift)>this.width/2?Math.round(this.shift/this.width):"",e=this.getNextCoordinates(s);this.scroll(e,this.options.baseTransition),this.pressed=!1}galleryPopup(){const t=document.querySelectorAll("#gallery-popup");for(let s=0;s<t.length;s++){if(this.popup=t[s],this.imageItems=document.querySelectorAll("[data-clickImg]"),this.btnClose=this.popup.querySelector(".popup__close"),!this.popup.classList.contains("_show"))for(let t=0;t<this.imageItems.length;t++)this.imageItem=this.imageItems[t],this.imageItem.addEventListener("click",this.galleryPopupOpen.bind(this));this.popup.addEventListener("click",this.galleryPopupClose.bind(this)),this.btnClose.addEventListener("click",this.galleryPopupCloseBtn.bind(this))}}galleryPopupOpen(t){t.preventDefault(),this.popup.classList.add("_show");const s=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";document.body.classList.add("_lock"),document.querySelector(".wrapper").style.paddingRight=s,document.querySelector(".header__wrapper").style.paddingRight=s;const e=t.currentTarget;let i=Array.from(this.imageItems).indexOf(e);if(this.current=i,this.next=this.current+1,-1==i)return;this.next=i*this.options.visibleItems,this.next=this.next<=this.max?this.next:this.max;const o=this.coordinates[this.next],h=Math.abs(this.current-this.next),n=this.options.baseTransition+.07*h;this.scroll(o,n)}galleryPopupClose(t){this.popup.classList.contains("_show")&&(t.target.closest(".item picture")||t.target.closest(".popup__close")||t.target.closest(".control-gallery")||(this.popup.classList.remove("_show"),document.body.classList.remove("_lock"),document.querySelector(".wrapper").style.paddingRight="0px",document.querySelector(".header__wrapper").style.paddingRight="0px"))}galleryPopupCloseBtn(t){t.preventDefault(),this.popup.classList.contains("_show")&&(this.popup.classList.remove("_show"),document.body.classList.remove("_lock"),document.querySelector(".wrapper").style.paddingRight="0px",document.querySelector(".header__wrapper").style.paddingRight="0px")}getNextCoordinates(t){if("number"!=typeof t)return this.coordinates[this.current];if(this.options.autoScroll&&this.current>=this.count-this.options.visibleItems)this.next=0;else{if(0==this.current&&-1==t||this.current>=this.max&&1==t)return;this.next+=t}return this.coordinates[this.next]}scroll(t,s){"number"==typeof t&&(this.stage.style.cssText=`width:${this.widths}px; height:${this.items[0].offsetHeight}px; transform:translateX(${t}px); transition:${s}s`,this.current=this.next<this.max?this.next:this.max,this.options.nav&&this.setNavStyle(),this.options.dotts&&this.setDotsStyle())}}
//# sourceMappingURL=gallery.min.js.map
